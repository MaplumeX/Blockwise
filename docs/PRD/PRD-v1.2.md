---
文档类型: 产品需求文档 (PRD)
产品名称: Blockwise - 柳比歇夫时间管理 App
版本: v1.2
创建日期: 2026-01-18
最后更新: 2026-01-18
文档作者: Product Team
审核状态: 待审核
---

# Blockwise v1.2 版本功能需求

## 概述

v1.2 版本在 v1.1 基础上，对时间块视图（Time Block View）的布局方向做明确约束：采用“小时为行、分钟为列”的横向网格。即：1 小时 = 1 行，每行 12 格（5 分钟/格），时间记录在行内横向延展，保证阅读一致性与编辑可预期性。

**主要更新**：
1. 时间块视图布局方向明确（横向排列：1小时=1行，12格=60分钟）
2. 时间条目上下文菜单升级为底部半屏详情卡 + 操作区（Bottom Sheet，方案 1）

---

## 1. 时间块视图集成（更新）

### 1.1 功能定位

时间块视图（Time Block View）作为时间线模块的另一种可视化形式，通过网格式布局帮助用户直观理解一天 24 小时的时间分配，并支持基于网格的快速创建与查看。

### 1.2 布局方向约束（新增）

**核心约束**：时间块视图必须为“横向排列”的网格。

- **一小时一行**：一天 24 行，每行代表 1 小时（00–23）。
- **一行 12 格**：每行 12 列，每列代表 5 分钟（12×5 分钟 = 60 分钟）。
- **记录段横向延展**：同一条时间记录在单小时内的部分，必须在该小时行内以横向连续胶囊段呈现（覆盖对应的 5 分钟格子）。
- **跨小时切片**：记录跨越多小时，按小时行切片显示（每小时一段），但整体视觉需保持同色、对齐与连续感。
- **滚动方向**：仅支持垂直滚动浏览 24 小时；不支持横向滚动（列数固定，保证时间尺度一致）。

### 1.3 视图切换

- 在时间线页面顶部提供视图切换按钮（列表图标 ↔ 日历图标）。
- 保存用户的视图偏好，下次打开时恢复。
- 两个视图共享相同数据源；在任一视图中的创建/编辑/删除需实时同步到另一视图。
- 选中的日期在两个视图间保持一致。

### 1.4 时间轴与网格

- 左侧固定 24 小时纵向时间轴（00–23），每小时一行。
- 右侧为分钟网格（固定 5 分钟/格）。
- 时间文字使用等宽字体（Monospace），12sp，次要文字颜色；右对齐，距网格 8dp。

### 1.5 时间块设计（网格 + 连续段胶囊）

**A. 底层：分钟网格（Heatmap Grid）**

- 时间粒度：固定 5 分钟/格（v1.2 固定，不提供用户配置）。
- 网格样式：每格为小方块或轻圆角方块；空白格使用低对比背景色；分割使用极浅分隔线或间距。

**B. 上层：记录段（Entry Segment Capsule）**

- 基本规则：同一条时间记录（TimeEntry）在网格上覆盖其时间范围内的所有格子，并在上层以“胶囊条带”连续呈现。
- 跨小时表现：
  - 记录开始行：左端圆角；记录结束行：右端圆角；中间行两端为直角。
- 颜色方案：
  - 段背景色使用活动类型颜色；透明度 80%–90%；可用 1dp 同色系更深描边或轻阴影区分相邻段。
- 内容显示（自适应）：
  - 默认不在单格内显示文字。
  - 当连续段长度足够（建议 ≥ 10 分钟）时，允许在段的首行显示活动名称（1 行省略号）。
  - 当连续段更长（建议 ≥ 60 分钟）时，可显示时间范围（如 09:00–10:30）。

**C. 未记录时间段（空白段提示）**

- 空白默认仅以空白格呈现；当用户点击空白区域时，系统可临时高亮“连续空白段”。

---

## 2. 时间条目上下文菜单（新增）

### 2.1 目标

将时间条目（TimeEntry）的“上下文菜单”从就地浮动菜单升级为“底部半屏详情卡 + 操作区（Bottom Sheet）”，在不增加操作步骤的前提下：

- 提升可读性：先看清条目信息，再做操作
- 降低误触：将危险操作与常用操作分区
- 支持扩展：为后续增加“快捷编辑/标签/备注”等入口预留结构

### 2.2 触发方式

- 单击时间条目：直接展示固定高度的半屏 Bottom Sheet（不可拖拽调整高度）。
- 长按时间条目：进入多选模式（见 2.8）。

### 2.3 Bottom Sheet 总体布局（更新：方案 1 具体UI）

Bottom Sheet 为固定高度的半屏弹层（不可拖拽调整高度），采用“顶部小按钮 + 主内容区 + 底部大按钮”的结构，整体从上到下为：

- 顶部：少量小图标按钮（不常用操作，含删除）+ 右上角关闭按钮
- 主内容区：时间滚轮（起始/结束）、活动类型（常用列表）、标签、备注
- 底部：大按钮（修改、拆分）

关闭行为：

- 点击右上角关闭按钮关闭
- 点击半屏外的上方遮罩区域关闭

### 2.4 顶部悬浮操作区（小按钮，不常用）

- 位于 Bottom Sheet 顶部区域，以无背景的小图标按钮呈现（视觉上像“直接浮在 sheet 上方”）。
- 仅放置不常用操作，避免干扰主编辑流程；图标本身无底色/无胶囊背景，但点击热区需满足最小触摸目标（建议 ≥ 48dp），按下态可用轻量高亮/ripple。
- 顶部按钮布局：
  - 左侧区域：合并（图标按钮，可无文字）
  - 右侧区域：删除（图标按钮，无文字）紧贴关闭按钮左侧；关闭（✕）位于右上角
- v1.2 顶部仅包含：合并、删除、关闭。

### 2.5 主内容区

**A. 时间范围（占一行，双滚轮）**

- 同一行左右并排两个滚轮：
  - 左侧：起始时间滚轮
  - 右侧：结束时间滚轮
- 滚轮默认按 1 分钟步进（精确到分钟）。
- 变更时间后，需即时更新时长展示（可作为次要小字显示在该行下方或右侧）。

**B. 活动类型（两行，常用列表）**

- 展示“常用活动类型”列表，固定两行展示（优先减少横向滚动）。
- 每个活动类型以 Chip/按钮呈现；点击即可切换该条目的活动类型；当前选中态需高亮。
- 提供“更多”活动类型入口（放在第二行末尾），打开完整选择器。

**C. 标签（新增）**

- 在活动类型区域下方提供“添加标签”按钮。
- 点击“添加标签”进入标签选择/创建流程；已选标签以 Chip 形式展示（可折叠为 +X）。

**D. 备注（多行输入区）**

- 备注为多行输入区（TextArea），空状态也占位并显示占位文案。
- 备注区需有最小高度（例如 88dp/96dp）；内容可在合理上限内扩展，超过上限后内部滚动或提供展开编辑入口（二选一即可）。

### 2.6 底部主操作区（大按钮）

- 位于 Bottom Sheet 最底部，提供 2 个大按钮：
  - 修改：确认并保存对时间范围/活动类型/备注的修改
  - 拆分：进入拆分流程（若不满足拆分条件则置灰并给出原因）

### 2.7 删除与安全策略（更新：删除移至顶部小按钮）

- 删除属于危险操作，放置在顶部悬浮操作区，避免与底部主按钮并列。
- 删除后必须提供撤销（Undo）入口（例如 Snackbar：“已删除时间记录” + “撤销”）。
- 若不做 Undo，则必须提供二次确认；v1.2 默认优先采用 Undo。

### 2.8 多选模式（与 Bottom Sheet 协同）

- 长按进入多选模式后：不再为单条弹 Bottom Sheet。
- 多选状态下提供批量操作栏（位置在底部操作栏）：
  - 删除
  - 合并（仅在规则满足时启用）
- 退出多选模式：返回单击弹 Bottom Sheet 的交互。

### 2.9 状态与可访问性

- 加载态：若条目详情需异步加载，Bottom Sheet 在主内容区提供骨架/占位。
- 无障碍：TalkBack 聚焦顺序为“顶部小按钮 → 时间滚轮 → 活动类型 → 备注 → 底部大按钮”；危险操作需明确语义提示。

---

## 3. 成功指标（延续）

- 时间块视图切换响应时间 < 500ms
- 滚动帧率保持在 55fps 以上
- 内存占用 < 100MB
