---
文档类型: 总任务文档
产品名称: Blockwise - 柳比歇夫时间管理 App
来源PRD: docs/PRD/PRD-v1.1.md
版本: v1.1
创建日期: 2026-01-17
最后更新: 2026-01-17
文档作者: Sisyphus
---

# Blockwise v1.1 总任务文档

## 整体目标

在 v1.0 的时间线基础上，v1.1 聚焦“时间线体验升级 + 时间块视图(Time Block View)集成”，让用户更直观地查看一天 24 小时分配、更高效地筛选/跳转日期、并更顺滑地完成创建/编辑等高频操作。

## 范围与约束

- **范围（本期必须交付）**
  - 时间线 UI 视觉风格升级：垂直时间轴、卡片信息结构调整、时间范围 Monospace + 背景块、未追踪时间段卡片。
  - 导航与筛选增强：顶部周范围标题、横向滚动日期选择器（本周 7 天）、左右滑动切周、日历弹层快速跳转、今天快捷入口。
  - 交互优化：记录卡片点击上下文菜单（编辑/删除/拆分/合并/复制/分享）、长按进入多选。
  - 时间块视图集成：与时间线视图切换、视图偏好持久化、数据源共享与实时同步、24×12（5分钟格）网格 + 段胶囊渲染、点击查看详情、空白长按拖拽范围创建、重叠容错提示、骨架屏、缓存与预加载、可访问性支持。

- **非目标（v1.1 不做或不承诺）**
  - 时间粒度用户可配置（v1.1 固定 5 分钟/格）。
  - 时间块视图横向滚动/时间尺度缩放（PRD 明确不支持横向滚动；缩放手势未在 v1.1 必选交互中）。
  - 重叠记录的“并排分列”展示（PRD 要求纹理叠加 + 警示描边，点击弹出冲突列表）。

## 成功指标（验收目标）

- **用户体验**
  - 时间线页面平均停留时长 +20%
  - 记录编辑操作平均步骤 -30%
  - 时间线 UI 满意度 > 4.5/5
  - 时间块视图使用率 > 50%
  -（如实现拖拽调整）时间块拖拽调整使用率 > 30%

- **性能**
  - 时间线首屏加载 < 1s
  - 滚动帧率 >= 55fps
  - 内存占用 < 100MB
  - 时间块视图切换响应 < 500ms
  -（如实现拖拽调整）拖拽操作延迟 < 16ms（60fps）

- **功能使用率**
  - 日期选择器使用率 > 60%
  - 手势/上下文菜单使用率 > 40%
  - 未追踪时间段点击创建率 > 30%
  - 视图切换频率 > 3 次/会话

## 里程碑规划

> 里程碑按“可独立交付/可验收”切分；每个里程碑包含关键交付物与验收要点。

### M1: 时间线视觉升级（Timeline Visual Refresh）

- **关键交付物**
  - 垂直时间轴：左侧连接线（2dp，浅/深色适配，圆角）+ 节点圆点（14dp）。
  - 记录卡片信息结构调整：移除左侧细条；右上角活动类型；标题=备注（无备注则活动类型名）；标题下方显示起止时间。
  - 时间范围样式：Monospace + 浅色背景块（圆角 4dp，padding 6×3dp）。

- **验收要点**
  - 时间线列表视觉结构符合 PRD v1.1；浅/深色模式可读性一致。
  - 列表滚动无明显掉帧；卡片复用/重组次数可控。

### M2: 未追踪时间段（Untracked Gap）

- **关键交付物**
  - 在连续记录之间间隔 >= 1 分钟时，插入“未追踪时间段”卡片：虚线边框、透明背景、显示时间范围。
  - 点击“未追踪时间段”可快速创建该时间段记录（开始/结束时间预填）。

- **验收要点**
  - 间隔识别准确（边界：跨天、首尾记录、1 分钟阈值）。
  - 点击创建入口直达创建流程，时间预填正确。

### M3: 日期导航与快速跳转（Week Strip + Calendar Jump）

- **关键交付物**
  - 顶部周范围标题（例："1月15日 - 1月21日"）。
  - 本周 7 天横向滚动日期按钮：56×72dp、圆角 12dp；选中/未选中状态；“今天”标记。
  - 左右滑动切周：保持“选中星期”语义（切到上一周仍默认选中上周同一星期）。
  - 点击周范围标题弹出日历视图；提供“今天”快捷按钮。
  - 切换日期时平滑过渡动画。

- **验收要点**
  - 日期切换与数据加载一致（不闪动、不显示错误日期数据）。
  - 切周逻辑符合 PRD 描述；今天按钮行为明确可预测。

### M4: 时间线交互优化（Context Menu + Multi-select）

- **关键交付物**
  - 点击记录卡片弹出浮动上下文菜单（显示在点击位置附近）：编辑、删除、拆分、合并、复制、分享。
  - 长按进入多选模式；多选后可继续点击其他卡片。

- **验收要点**
  - 菜单操作与现有数据层一致（编辑/删除等动作正确，状态回写及时）。
  - 多选模式进入/退出清晰；误触成本低。

### M5: 时间块视图 MVP（Grid + Segment Capsule Rendering）

- **关键交付物**
  - 时间线/时间块视图切换按钮（列表图标 ↔ 日历图标）。
  - 视图偏好持久化：再次打开恢复用户上次选择。
  - 共享数据源：两视图创建/编辑/删除实时同步；选中日期保持一致。
  - 时间块布局：左侧 24 小时轴（00–23，Monospace 12sp，右对齐），右侧 5 分钟格（24×12=288），垂直滚动，时间轴固定。
  - 记录段胶囊渲染：按 TimeEntry 覆盖范围，跨小时按行切片但视觉连续；起/止行圆角，中间行直角；颜色=活动类型色，透明度 80%-90%，1dp 边框或轻阴影。

- **验收要点**
  - 渲染准确：时间到网格映射无偏移；跨小时切片连续性正确。
  - 性能可预测：避免逐格渲染 TimeEntry；按“连续范围”渲染。

### M6: 时间块核心交互（Select + Detail + Range Create）

- **关键交付物**
  - 点击记录段：选中整条记录（跨小时所有切片同时高亮）；底部弹出详情卡片（活动、时间范围、时长、备注、标签、快捷操作）。
  - 长按空白区域并拖拽：范围选择对齐 5 分钟网格；松手弹出创建对话框并预填起止时间。

- **验收要点**
  - 吸附到最近 5 分钟格的规则一致；创建时间预填与用户选择一致。
  - 选中态与弱化未选中段的视觉反馈清晰（不影响可读性）。

### M7: 容错、加载态、缓存与可访问性

- **关键交付物**
  - 重叠记录容错：重叠格“纹理叠加 + 警示描边”；点击弹出冲突列表并引导用户编辑/删除。
  - 空状态：无记录仍显示完整网格，并提示“今天还没有记录”。
  - 切换日期加载骨架屏：优先模拟“网格 + 少量胶囊段”。
  - 数据缓存与预加载：缓存已加载日期；预加载前后一天。
  - 无障碍：记录段语义化描述（活动名 + 时间范围 + 时长）；TalkBack 聚焦在“记录段”层级；触摸目标以“小时行”为基础（行高建议 >= 48dp）。

- **验收要点**
  - 重叠提示不制造误导；冲突列表入口稳定可达。
  - 预加载不会造成错误日期数据污染；内存占用可控。
  - TalkBack 不逐格朗读；焦点顺序合理。

### M8: 性能回归与指标埋点

- **关键交付物**
  - 性能基准验证：时间线首屏 <1s、滚动 >=55fps、内存 <100MB；时间块切换 <500ms。
  - 指标埋点（或等价可观测方案）：日期选择器使用、上下文菜单使用、未追踪段点击创建、视图切换次数/会话、时间块视图使用率。

- **验收要点**
  - 指标口径定义清晰、可复现；可在测试环境验证事件是否上报。

## 关键交付物清单（汇总）

- 时间线 UI：垂直轴线/节点、卡片结构升级、时间范围样式、未追踪时间段卡片。
- 导航：周范围标题、周内日期条、切周、日历跳转、今天快捷入口、切换动画。
- 交互：记录上下文菜单、多选模式。
- 时间块视图：视图切换与偏好、共享数据源同步、24×12 网格、段胶囊渲染、选中与详情、空白范围创建。
- 容错与体验：重叠提示与冲突列表、空状态、骨架屏、缓存/预加载、当前时间指示器（如实现）。
- 可访问性与性能：TalkBack 语义与焦点、性能达标验证。
- 可观测性：成功指标对应埋点/统计口径。

## 依赖与风险

- **依赖**
  - 需要时间记录数据源支持按日期查询、按时间排序，以及创建/编辑/删除的稳定数据流。
  - 需要活动类型颜色体系（TimeEntry -> ActivityType color）稳定可用。

- **主要风险**
  - 时间块视图交互（范围选择/吸附/滚动）若实现方式不当，容易引发掉帧或误触。
  - 重叠记录在数据层不常见，但需保证 UI 容错逻辑不会影响正常渲染路径。
  - 骨架屏/预加载若与状态管理耦合不清晰，可能造成日期切换时“显示旧数据”的错觉。

## 变更历史

- 2026-01-17: v1.1 初版，根据 PRD v1.1 拆解里程碑与交付物。